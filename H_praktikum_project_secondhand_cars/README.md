# Определение стоимости автомобиля на вторичном рынке

## Задача
Сервис по продаже подержанных автомобилей разрабатывает приложение, в котором клиент может быстро узнать рыночную стоимость автомобиля, введя информацию о пробеге, комплектации, тх и проч. В нашем распоряжении размеченные исторические данные. Вам нужно построить модель для определения стоимости. 

Задача: __построить модель для определения стоимости автомобиля по его характеристикам__. Заказчику важны __качество предсказания__ (Ключевая метрика - RMSE), __скорость предсказания__, __время обучения__.

## Описание проекта
В ходе проекта использовались:
- библиотеки *Pandas*, *NumPy*, *copy*, *random*;
- *scikit-learn*: алгоритм *RandomForestRegressor*; *train_test_split*; *OrdinalEncoder* для кодирования категориальных признаков;
- алгоритмы градиентного бустинга *CatBoost* и *LightGBM*;
- для графиков использовались *matplotlib.pyplot* и *seaborn*.

После загрузки в данных обнаружились пропуски и аномалии. Был произведен осмотр распределений значений признаков, аномалии были удалены. Пропущенные значения заполнялись с учетом предпосылки, что пропуски можно заполнить наиболее встречающимися или медианными значениями искомого признака, которые уже есть в таблице, среди объектов, объединенных рядом свойств. Объекты разбивались на группы по ряду факторов, брались медианные (для количественных) или наиболее многочисленные (для категориальных) наличествующие значения, которые принимает признак, пропуски в котором планировалось заполнить, и заполнялись ими пропуски для объектов, относящимися к соответствующим группам.  

Для этого были определены две функции, которые принимали два/четыре признака - фактор 1 и фактор 2 (фактор 3 и фактор 4)- по которым объекты делились на группы, и третий (пятый) признак - тот, пропуски которого планировалось заполнить. 
На выходе получали столбец со значениями искомого признака, рассматривали его, добавляли его в основной датафрейм, заменив им старый столбец с пропусками, сократив таким образом количество пропусков. Затем повторяли операцию с другими столбцами, добавляя в чисто признаков-факторов столбцы с сократившимся количеством пропусков. В результате проблема с пропусками была решена.
Дубликаты были удалены. Типы данных приведены к подходящим.
Перед обучением были удалены признаки, не влияющие на цену автомобиля. Кроме того, был подготовлен датасет, в котором категориальные данные были закодированы. 

Затем был произведен подбор моделей. Моделям на CatBoostRegressor передавались данные с не закодированными категориальными данными, LGBMRegressor и RandomForestRegressor - с закодированными категориальными признаками. Были отобраны модели каждого алготима с лучшими показателями на валидационной выборке, затем было произведено сравнение их показателей на тестовой выборке. Учитывались как качество модели, так и скорость обучения и предсказания.

В итоге лучший результат показала модель на CatBoostRegressor. 






