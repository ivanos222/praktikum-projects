# Машинное обучение для текстов: классификация комментариев
## Задача
Заказчику - некому интернет-магазину - для оптимизации модерирования комментариев необходима модель, которая будет определять, токсичный ли комментарий оставил пользователь, или нет. 

Цель - обучить модель, которая решала бы задачу классификации, разделяя комментарии на позитивные и негативные. Для обучения модели есть размеченный набор комментариев. 

Заказчик требует от модели значение метрики *F1* не меньше 0.75. 

Столбец *text* в исходном датафрейме содержит текст комментария, *toxic* — указание, токсичный коментарий, или нет, целевой признак.

## Описание проекта

В проекте использовались следующие библиотеки:  
- *nltk* (*natural language toolkit*): *word_tokenize* для токенизации, *WordNetLemmatizer* с Part-of-Speech (POS) тэгами для лемматизации, *stopwords* для векторизации;  
- *re* (*regular expressions*) для очистки;  
- средства *scikit-learn*: *TfidfVecrorizer* для векторизации текстов, *LogisticRegression* и *RandomForestClassifier* для создания и подбора моделей, *f1_score* для ключевой метрики;  
- также для создания моделей использовался алгоритм *CatBoostClassifier*;  
- вспомогательно использовались *Pandas*, *NumPy*, *Math* и *Copy*.  

Перед началом подбора модели размеченный корпус был обработан. Классифицированный текст был приведен к нижнему регистру, очищен от лишних знаков с помощью *re*.  
Затем была проведена токенизация текста с помощью *nltk.word_tokenize*.  
После этого для сравнения была произведена лемматизация текста посредством *WordNetLemmatizer* с POS-тэгами и без них. С POS-тэгами получилось лучше.  
После этого корпус был разбит на обучающую, валидационную и тестовую выборки и векторизирован с помощью *TdidfVectorizer*.

Затем последовал подбор модели, заключавшийся в переборе гиперпараметров для алгоритмов логистической регрессии, случайного леса и градиентного бустинга CatBoost, обучающихся на обучающей выборке и проверяемой на валидационной. На валидационной выборке лучший результат продемонстрировала одна из моделей на CatBoost. На тестовой выборке она также преодолела установленный заказчиком порог. Эта же модель, обученная на совокупности обучающей и валидационной выборок продемонстрировала на тестовой лучший (хоть и не сильно) результат.
