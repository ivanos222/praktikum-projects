# Компьютерное зрение для прикассовых зон супермаркетов

## Задача
Сеть супермаркетов планирует внедрить в своих магазинах систему компьютерного зрения для обработки фотографий покупателей. Система должна определять возраст клиентов по фотографиям, сделанным в прикассовой зоне, чтобы анализировать покупки и персонализировать предложение для каждого клиента, а также чтобы контролировать добросовестность кассиров при продаже алкоголя.

Необходимо __построить модель, определяющую приблизительный возраст человека по фотографии__. Метрикой по просьбе заказчика выступает MAE, заказчик сообщил, что MAE < 7 - отличный результат. В нашем распоряжении размеченный набор портретных фотографий людей.

## Описание проекта
Для предварительного осмотра изображений:
- использовался загрузчик *ImageDataGenerator* из *tensorflow.keras.preprocessing.image*;
- для вывода изображений использовался *Matplotlib.pyplot* и *PIL.Image*;
- также вспомогательно использовались *Pandas* и *NumPy*;

Загрузчик обраружил 7591 изображение. Выгрузка была установлена батчами по 32 изображения 224 на 224 пикселя с 3 цветовыми каналами.

Изображения в большинстве цветные, хотя встречаются и черно-белые. Большинство людей на фотографиях запечатлены анфас или в полоборота, хотя еть фотопортреты в профиль.   
Обратим внимание на то, что часть изображений уже слегка наклонены и смещены.  
Возраст в целом распределен нормально со скошенностью вправо, если не считать увеличенного количества фотографий детей до 10 лет. 

Затем была создана сверточная нейронная сеть:
- на основе средств библиотеки *TensorFlow.Keras*, а также *Pandas*;
- на архитектуре ResNet с пятьюдесятью слоями (*ResNet50* из *Keras*) с двумя верхними слоями *GlobalAveragePooling2D* и *Dense* с функцией активации RelU;
- на алгоритме обучения Adam с learning rate равным 0.0001;
- с загрузчиком *ImageDataGenerator* с аугментацией - горизонтальным отражением;
- с функцией потерь - средней квадратичной ошибкой;
- с метрикой MAE;

В результате ResNet50 с показала себя отлично. Данных в предоставленном датасете достаточно, чтобы использовать предобученную на ImageNet сеть без замораживания. Сеть справилась с потенциальным недостатком фото людей старшего возраста или с относительным переизбытком детский фотографий. __Порог качества, установленный заказчиком, преодолен, MAE < 6__.
