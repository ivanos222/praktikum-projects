# Временные ряды: прогнозирование спроса на такси

## Задача
Некая компания, работающая на рынке такси, обладает историческими данными о заказах такси и хочет использовать их для __прогнозирования спроса на такси (количество заказов) на следующий час__, чтобы оптимизировать управление количеством водителей.  

Необходимо построить модель для такого предсказания. Заказчик требует, чтобы значение *RMSE* на тестовой выборке было не больше 48.

## Описание проекта
В ходе проекта использовались:
- *seasonal_decompose* из *statsmodels.tsa.seasonal*;
- библиотки *Pandas* и *NumPy*;
- средства *scikit-learn*: алгоритмы *LinearRegression*, *RandomForestRegressor*; метрика *mean_squared_error*; *train_test_split*;
- *matplotlib.pyplot* для визуализации.

Данные после загрузки были проверены на наличие дубликатов, даты были назначены индексами, проверены на монотонность и ресемплированы по одному часу.

После этого с помощью *seasonal_decompose* было получено общее представление о тренде и сезонности, которое в случае тренда было детальнее рассмотренно с помощью скользящего среднего, а в случае с сезонностью - благодаря уменьшению масштаба. Было обнаружено две сезонности - в пределах недели и в пределах дня. 

Затем была определена функция, принимающая на вход датасет, размер максимального лага в часах и размер окна скользящего среднего и выдающая датасет со столбцом скользящего среднего для каждой строчки, для которой возможно его рассчитать, и с добавленными столбцами лага - по количеству, переданному аргументом max_lag - фиксирующими для каждой строчки значение целевого признака со все возрастающим в зависимости от столбца лагом.  
С помощью этой функции было подготовлено несколько вариантов датасета, все они были разбиты на выборки и переданы функциям, перебирающим гиперпараметры для линейной регрессии и случайного леса. 

В результате модель с наилучшим показателем на валидационной выборке - ей оказалась модель, обученная на датасете с наибольшим максимальным лагом, способным отразить обе сезонности - обучалась на совокупности (упорядоченной по дате) обучающей и валидационной выборок и проверена на тестовой выборке. 
Удалось получить предсказания на тестовой выборке, значение RMSE которых не превышает 48 и значительно ниже аналогичного показателя предсказаний на валидационной выборке, полученных на наборе данных с меньшим значением максимального лага. Предположение, выдвинутое на основании анализа, о влиянии двух сезонностей, подтвердилось, а модель можно передавать заказчику.

