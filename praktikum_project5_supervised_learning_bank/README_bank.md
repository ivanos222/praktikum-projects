# Отток клиентов из банка

## Задача
Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет, на основании исторических данных о поведении клиентов и расторжении договоров с банком. 

Заказчик требует доведение метрики *F1* до 0.59. 
Дополнительно измеряется *AUC-ROC*, её значение сравнивается с *F1*-мерой.

Источник данных (данные немного изменены): [https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling](https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling)

## Описание проекта
В проекте были использованы:
 - *Pandas*;
 - *scikit-learn*: - алгоритмы *LogisticRegression*, *DecisionTreeClassifier*, *RandomForestClassifier*; метрики *f1_score*, *roc_auc_score*, *recall_score*, *precision_score*, *accuracy_score*; *confusion_matrix* и *roc_curve* для анализа результатов; *StandardScaler* и *OrdinalEncoder* для масштабирования и кодирования признаков;
 - *matplotlib* для визуализации.

После загрузки данные были осмотрены и обработаны. Пропуски наличествовали в одном столбце, они были заполнены медианами групп объектов, получившихся в результате группировки по двум наиболее коррелирующим с этим столбцом признакам. Дубликаты не были обнаружены, регистр названий стобцов был заменен, типы данных были приведены к подходящим, столбцы, непригодные для обучения моделей, были удалены, ряд категориальных признаков был закодирован прямым и порядковым (для деревьев решений и случайного леса) методами.

Перед началом подбора модели был выявлен дисбаланс классов целевого признака, положительных значений было всего около 20%.

После этого данные были разбиты на три выборки, отмасштабированы (на основе обучающей выборки), для каждого алгоритма был произведен перебор гиперпараметров и зафиксированы метрики для каждого сочетания гиперпараметров, взаимное поведение метрик, как распределение ошибок были проанализированы. Модели случайного леса показали удовлетворительный результат, однако на основе анализа результатов был определен потенциал для улучшения модели, заключавшийся в борьбе с дисбалансом классов целевого признака.

Были опробованы два способа борьбы с дисбалансом - балансировка и увеличение выборки - в результате чего лучшие результаты показала модель случайного леса с увеличенной выборкой. На тестовой выборке ей едва удалось пересечь порог, что подтверждает, что дополнительные меры по улучшению качества модели были не зря.
